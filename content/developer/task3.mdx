---
title: "Task 3 — Exchange Connector"

description: Info on Exchange connector
---

import Callout from "../../src/components/Callout";

## Overview

The **_Class Diagram_**, given below, details the critical variables and functions in the `Exchange` class. The primary bulk of implementing a new exchange connector is in this task.
The functions of the `Exchange` class can be catergorized into:

[**(1) Placing Orders**](#1-placing-orders)<br/>
[**(2) Cancelling Orders**](#2-cancelling-orders)<br/>
[**(3) Tracking Orders & Balances**](#3-tracking-orders--balances)<br/>
[**(4) Managing Trading Rules**](#4-managing-trading-rules)<br/>
[**(5) Additional Functions**](#5-additional-functions)<br/>
[**(6) Class Properties**](#6-class-properties)

Although this might seem pretty straightforward, it does require a certain level of understanding and knowing the expected side-effect(s) of certain functions.

![ExchangeUMLDiagram](/img/exchange-class.svg)

<Callout
  type="note"
  body="The 4 categories of functions broadly covers the necessary functions that need to be implemented in the `Exchange` class, so feel free to include other utility functions as needed."
/>

## (1) Placing Orders

The `Exchange` class places orders by either calling the [`buy()`](#buy) or [`sell()`](#sell) method.
Both these methods first generates a client order ID for the order which will be used locally by Hummingbot to track the orders before calling the [`_create_order()`](#_create_order) method.

### `buy()`

Function that takes the strategy inputs, generates a client order ID(used by Hummingbot for local order tracking), and places a **buy** order by calling the [`_create_order()`](#_create_order) function.

**Input Parameter(s):**

| Parameter(s)   | Type        | Description                                                                               |
| -------------- | ----------- | ----------------------------------------------------------------------------------------- |
| `trading_pair` | `str`       | Name of the trading pair symbol(in Hummingbot's format i.e. `BASE-QUOTE`)                 |
| `price`        | `Decimal`   | Price in which the order will be placed in `Decimal`                                      |
| `amount`       | `Decimal`   | Amount in which the order will be placed in `Decimal`                                     |
| `order_type`   | `OrderType` | Specifies the order type of the order(i.e. `OrderType.LIMIT` and `OrderType.LIMIT_MAKER`) |

**Expected Output(s):** order_id: `str`

### `sell()`

Function that takes the strategy inputs, generates a client order ID(used by Hummingbot for local order tracking), and places a **sell** order by calling the [`_create_order()`](#_create_order) function.

<!-- **Input Parameter(s):**

| Parameter(s)   | Type        | Description                                                                               |
| -------------- | ----------- | ----------------------------------------------------------------------------------------- |
| `trading_pair` | `str`       | Name of the trading pair symbol(in Hummingbot's format i.e. `BASE-QUOTE`)                 |
| `price`        | `Decimal`   | Price in which the order will be placed in `Decimal`                                      |
| `amount`       | `Decimal`   | Amount in which the order will be placed in `Decimal`                                     |
| `order_type`   | `OrderType` | Specifies the order type of the order(i.e. `OrderType.LIMIT` and `OrderType.LIMIT_MAKER`) |

**Expected Output(s):** order_id: `str` -->


<details>
  <summary><p style="display:inline"><strong>Input Parameter(s):</strong></p></summary>


| Parameter(s)   | Type        | Description                                                                               |
| -------------- | ----------- | ----------------------------------------------------------------------------------------- |
| `trading_pair` | `str`       | Name of the trading pair symbol(in Hummingbot's format i.e. `BASE-QUOTE`)                 |
| `price`        | `Decimal`   | Price in which the order will be placed in `Decimal`                                      |
| `amount`       | `Decimal`   | Amount in which the order will be placed in `Decimal`                                     |
| `order_type`   | `OrderType` | Specifies the order type of the order(i.e. `OrderType.LIMIT` and `OrderType.LIMIT_MAKER`) |

</details>


<details>
  <summary><p style="display:inline"><strong>Expected Output(s):</strong></p></summary>


| Output(s)  | Type  | Description     |
| ---------- | ----- | --------------- |
| `order_id` | `str` | Client Order ID |

</details>


### `_create_order()`

This function is responsible for executing the API request to place the order on the exchange. It does the following:

- Verifies that the orders would be legal based on the trading rules pulled from the exchange.
- Quantize the order amount to ensure that the precision is as required by the exchange.
- Create a `params` dictionary with the necessary parameters for the desired order.
- Pass the `params` to an `Auth` object to generate the request signature.
- Begin tracking the order by calling [`start_tracking_order(...)`](#start_tracking_order).
- Places the order by calling the [`_api_request()`](#_api_request) method with the relevant order parameters.
- Upon successfully placing the order, the tracked order will be updated with the resulting **_exchange order ID_** from the API Response.

<Callout
  type="note"
  body="The tracked order is an `InFlightOrder` that is within a dictionary variable(`_in_flight_orders`) in the `Exchange` class. `InFlightOrder` are Hummingbot’s internal records of orders it has placed that remain open in the exchange. 
  When such orders are either filled or canceled, they are removed from the dictionary by calling [stop_tracking_order()] method, and the relevant event completion flag is passed to the strategy module."
  link={["#stop_tracking_order"]}
/>

**Input Parameter(s):**

| Parameter(s)   | Type                                                                                                       | Description                                                                               |
| -------------- | ---------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- |
| `order_id`     | `str`                                                                                                      | ID used to track an order in Hummingbot.                                                  |
| `trading_pair` | `str`                                                                                                      | Name of the trading pair symbol(in Hummingbot's format i.e. `BASE-QUOTE`)                 |
| `price`        | `Decimal`                                                                                                  | Price in which the order will be placed in `Decimal`                                      |
| `amount`       | `Decimal`                                                                                                  | Amount in which the order will be placed in `Decimal`                                     |
| `order_type`   | [`OrderType`](https://github.com/CoinAlpha/hummingbot/blob/master/hummingbot/core/event/events.py#L61-L69) | Specifies the order type of the order(i.e. `OrderType.LIMIT` and `OrderType.LIMIT_MAKER`) |
| `trade_type`   | [`TradeType`](https://github.com/CoinAlpha/hummingbot/blob/master/hummingbot/core/event/events.py#L61-L69) | Specifies the trade type of the order(i.e. `TradeType.BUY` and `TradeType.SELL`)          |

**Expected Output(s):** order_id: `None`

## (2) Cancelling Orders

The strategy and the `exit` command cancels orders by interacting calling [`cancel()`](#cancel) or [`cancel_all()`](#cancel_all) methods respectively.

### `cancel()`

### `cancel_all()`

### `_execute_cancel()`

## (3) Tracking Orders & Balances

### `start_tracking_order()`

### `stop_tracking_order()`

### `_user_stream_event_listener()`

### `_status_polling_loop()`

### `_update_balances()`

### `_update_order_status()`

### `_process_order_message()`

### `_process_trade_message()`

## (4) Managing Trading Rules

TBD

### `get_order_price_quantum()`

### `get_order_size_quantum()`

### `_trading_rules_polling_loop()`

### `_update_trading_rules()`

### `_format_trading_rules()`

## (5) Additional Function(s)

TBD

### `_api_request()`

## (6) Class Properties

TBD

## Debugging & Testing

As part of the QA process, for each tasks(Task 1 through 3) you are **required** to include the unit test cases for the code review process to begin. Refer to [Option 1: Unit Test Cases](/developer/debug&test/#option-1-unit-test-cases) to build your unit tests.
